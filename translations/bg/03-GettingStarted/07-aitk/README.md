<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "8248e3491f5245ee6ab48ef724a4f65a",
  "translation_date": "2025-07-13T21:41:29+00:00",
  "source_file": "03-GettingStarted/07-aitk/README.md",
  "language_code": "bg"
}
-->
# Използване на сървър от разширението AI Toolkit за Visual Studio Code

Когато създавате AI агент, не става въпрос само за генериране на умни отговори; важно е и агентът да може да предприема действия. Тук влиза в игра Model Context Protocol (MCP). MCP улеснява агентите да имат достъп до външни инструменти и услуги по последователен начин. Мислете за това като за включване на вашия агент в куфар с инструменти, който той *наистина* може да използва.

Да кажем, че свързвате агент с вашия MCP сървър за калкулатор. Изведнъж агентът може да извършва математически операции само като получи заявка като „Колко е 47 по 89?“ — без нужда от твърдо кодирана логика или създаване на специални API.

## Обзор

Този урок обхваща как да свържете MCP сървър за калкулатор към агент с разширението [AI Toolkit](https://aka.ms/AIToolkit) за Visual Studio Code, позволявайки на вашия агент да извършва математически операции като събиране, изваждане, умножение и деление чрез естествен език.

AI Toolkit е мощно разширение за Visual Studio Code, което улеснява разработката на агенти. AI инженери могат лесно да създават AI приложения, като разработват и тестват генеративни AI модели—локално или в облака. Разширението поддържа повечето основни генеративни модели, налични днес.

*Забележка*: AI Toolkit в момента поддържа Python и TypeScript.

## Цели на обучението

До края на този урок ще можете:

- Използвате MCP сървър чрез AI Toolkit.
- Конфигурирате агент, така че да открива и използва инструментите, предоставени от MCP сървъра.
- Използвате MCP инструменти чрез естествен език.

## Подход

Ето как трябва да подходим към това на високо ниво:

- Създайте агент и дефинирайте неговия системен промпт.
- Създайте MCP сървър с калкулаторни инструменти.
- Свържете Agent Builder със MCP сървъра.
- Тествайте извикването на инструменти от агента чрез естествен език.

Чудесно, сега, когато разбираме процеса, нека конфигурираме AI агент, за да използва външни инструменти чрез MCP, подобрявайки неговите възможности!

## Предварителни изисквания

- [Visual Studio Code](https://code.visualstudio.com/)
- [AI Toolkit за Visual Studio Code](https://aka.ms/AIToolkit)

## Упражнение: Използване на сървър

В това упражнение ще създадете, стартирате и подобрите AI агент с инструменти от MCP сървър във Visual Studio Code, използвайки AI Toolkit.

В това упражнение ще създадете, стартирате и подобрите AI агент с инструменти от MCP сървър вътре в Visual Studio Code, използвайки AI Toolkit.

### -0- Предварителна стъпка: добавете модела OpenAI GPT-4o към My Models

Упражнението използва модела **GPT-4o**. Моделът трябва да бъде добавен към **My Models**, преди да създадете агента.

1. Отворете **AI Toolkit** разширението от **Activity Bar**.
1. В секцията **Catalog** изберете **Models**, за да отворите **Model Catalog**. Избирането на **Models** отваря **Model Catalog** в нов редакторски таб.
1. В полето за търсене на **Model Catalog** въведете **OpenAI GPT-4o**.
1. Натиснете **+ Add**, за да добавите модела в списъка си **My Models**. Уверете се, че сте избрали модела, който е **хостван от GitHub**.
1. В **Activity Bar** потвърдете, че моделът **OpenAI GPT-4o** се появява в списъка.

### -1- Създайте агент

**Agent (Prompt) Builder** ви позволява да създавате и персонализирате свои собствени AI агенти. В този раздел ще създадете нов агент и ще му зададете модел, който да захранва разговора.

![Снимка на интерфейса на "Calculator Agent" в AI Toolkit за Visual Studio Code. В лявата част е избран моделът "OpenAI GPT-4o (via GitHub)." Системният промпт гласи "Вие сте професор в университет, който преподава математика," а потребителският промпт казва "Обясни ми уравнението на Фурие на прост език." Допълнителни опции включват бутони за добавяне на инструменти, активиране на MCP Server и избор на структурирано изходно съдържание. В долната част има син бутон „Run“. В дясната част, под "Get Started with Examples," са изброени три примерни агенти: Web Developer (с MCP Server, Second-Grade Simplifier и Dream Interpreter, всеки с кратко описание на функциите им).](../../../../translated_images/aitk-agent-builder.901e3a2960c3e4774b29a23024ff5bec2d4232f57fae2a418b2aaae80f81c05f.bg.png)

1. Отворете разширението **AI Toolkit** от **Activity Bar**.
1. В секцията **Tools** изберете **Agent (Prompt) Builder**. Това отваря **Agent (Prompt) Builder** в нов таб на редактора.
1. Натиснете бутона **+ New Agent**. Разширението ще стартира съветник за настройка чрез **Command Palette**.
1. Въведете името **Calculator Agent** и натиснете **Enter**.
1. В **Agent (Prompt) Builder**, за полето **Model**, изберете модела **OpenAI GPT-4o (via GitHub)**.

### -2- Създайте системен prompt за агента

След като агентът е създаден, време е да дефинирате неговата личност и цел. В този раздел ще използвате функцията **Generate system prompt**, за да опишете поведението на агента — в случая калкулатор — и моделът ще напише системния промпт вместо вас.

![Снимка на интерфейса на "Calculator Agent" в AI Toolkit за Visual Studio Code с отворен модален прозорец със заглавие "Generate a prompt." В прозореца се обяснява, че може да се генерира шаблон за промпт чрез споделяне на основни детайли и има текстово поле с примерен системен промпт: "Вие сте полезен и ефективен помощник по математика. Когато получите задача, свързана с основна аритметика, отговаряте с правилния резултат." Под текстовото поле има бутони "Close" и "Generate". На заден план се вижда част от конфигурацията на агента, включително избрания модел "OpenAI GPT-4o (via GitHub)" и полета за системен и потребителски промпт.](../../../../translated_images/aitk-generate-prompt.ba9e69d3d2bbe2a26444d0c78775540b14196061eee32c2054e9ee68c4f51f3a.bg.png)

1. В секцията **Prompts** натиснете бутона **Generate system prompt**. Този бутон отваря генератор на промпти, който използва AI, за да създаде системен промпт за агента.
1. В прозореца **Generate a prompt** въведете следното: `You are a helpful and efficient math assistant. When given a problem involving basic arithmetic, you respond with the correct result.`
1. Натиснете бутона **Generate**. В долния десен ъгъл ще се появи известие, че системният промпт се генерира. След като процесът приключи, промптът ще се появи в полето **System prompt** на **Agent (Prompt) Builder**.
1. Прегледайте системния промпт и го променете, ако е необходимо.

### -3- Създайте MCP сървър

След като сте дефинирали системния промпт на агента — който насочва поведението и отговорите му — е време да му осигурите практични възможности. В този раздел ще създадете MCP сървър за калкулатор с инструменти за събиране, изваждане, умножение и деление. Този сървър ще позволи на агента да извършва реални математически операции в отговор на заявки на естествен език.

![Снимка на долната част от интерфейса на Calculator Agent в AI Toolkit за Visual Studio Code. Показват се разширяеми менюта за „Tools“ и „Structure output“, както и падащо меню „Choose output format“ с избран „text“. Отдясно има бутон „+ MCP Server“ за добавяне на Model Context Protocol сървър. Над секцията Tools има икона на изображение като заместител.](../../../../translated_images/aitk-add-mcp-server.9742cfddfe808353c0caf9cc0a7ed3e80e13abf4d2ebde315c81c3cb02a2a449.bg.png)

*Забележка*: AI Toolkit в момента поддържа Python и TypeScript.

*Забележка*: В момента AI Toolkit поддържа Python и TypeScript.

1. В секцията **Tools** на **Agent (Prompt) Builder** натиснете бутона **+ MCP Server**. Разширението ще стартира съветник за настройка чрез **Command Palette**.
1. Изберете **+ Add Server**.
1. Изберете **Create a New MCP Server**.
1. Изберете **python-weather** като шаблон.
1. Изберете **Default folder**, за да запазите шаблона на MCP сървъра.
1. Въведете следното име за сървъра: **Calculator**
1. Ще се отвори нов прозорец на Visual Studio Code. Изберете **Yes, I trust the authors**.
1. Използвайки терминала (**Terminal** > **New Terminal**), създайте виртуална среда: `python -m venv .venv`
1. Използвайки терминала, активирайте виртуалната среда:
    1. Windows - `.venv\Scripts\activate`
    1. macOS/Linux - `source .venv/bin/activate`
1. Използвайки терминала, инсталирайте зависимостите: `pip install -e .[dev]`
1. В изгледа **Explorer** на **Activity Bar**, разширете директорията **src** и изберете **server.py**, за да отворите файла в редактора.
1. Заменете кода във файла **server.py** със следното и запазете:

    ```python
    """
    Sample MCP Calculator Server implementation in Python.

    
    This module demonstrates how to create a simple MCP server with calculator tools
    that can perform basic arithmetic operations (add, subtract, multiply, divide).
    """
    
    from mcp.server.fastmcp import FastMCP
    
    server = FastMCP("calculator")
    
    @server.tool()
    def add(a: float, b: float) -> float:
        """Add two numbers together and return the result."""
        return a + b
    
    @server.tool()
    def subtract(a: float, b: float) -> float:
        """Subtract b from a and return the result."""
        return a - b
    
    @server.tool()
    def multiply(a: float, b: float) -> float:
        """Multiply two numbers together and return the result."""
        return a * b
    
    @server.tool()
    def divide(a: float, b: float) -> float:
        """
        Divide a by b and return the result.
        
        Raises:
            ValueError: If b is zero
        """
        if b == 0:
            raise ValueError("Cannot divide by zero")
        return a / b
    ```

### -4- Стартирайте агента с MCP сървър за калкулатор

След като вашият агент има инструменти, е време да ги използва! В този раздел ще изпратите заявки към агента, за да тествате и валидирате дали агентът използва подходящия инструмент от MCP сървъра за калкулатор.

1. Натиснете `F5`, за да стартирате отстраняване на грешки на MCP сървъра. **Agent (Prompt) Builder** ще се отвори в нов таб на редактора. Статусът на сървъра се вижда в терминала.
1. В полето **User prompt** на **Agent (Prompt) Builder** въведете следния промпт: `I bought 3 items priced at $25 each, and then used a $20 discount. How much did I pay?`
1. Натиснете бутона **Run**, за да генерирате отговора на агента.
1. Прегледайте изхода на агента. Моделът трябва да заключи, че сте платили **$55**.
1. Ето какво трябва да се случи:
    - Агентът избира инструментите **multiply** и **subtract**, за да помогне с изчислението.
    - Съответните стойности за `a` и `b` се задават за инструмента **multiply**.
    - Съответните стойности за `a` и `b` се задават за инструмента **subtract**.
    - Отговорът от всеки инструмент се показва в съответното поле **Tool Response**.
    - Крайният резултат от модела се показва в полето **Model Response**.
1. Изпратете допълнителни промпти, за да тествате още агента. Можете да промените съществуващия промпт в полето **User prompt**, като кликнете в него и го замените.
1. Когато приключите с тестването, можете да спрете сървъра чрез терминала, като натиснете **CTRL/CMD+C**.

## Задание

Опитайте да добавите допълнителен инструмент към вашия файл **server.py** (например: връщане на квадратен корен на число). Изпратете допълнителни заявки, които биха изисквали агентът да използва вашия нов инструмент (или съществуващи инструменти). Уверете се, че сте рестартирали сървъра, за да заредите новодобавените инструменти.

## Решение

[Решение](./solution/README.md)

## Основни изводи

Основните изводи от тази глава са следните:

- Разширението AI Toolkit е отличен клиент, който ви позволява да използвате MCP сървъри и техните инструменти.
- Можете да добавяте нови инструменти към MCP сървъри, разширявайки възможностите на агента, за да отговарят на променящите се изисквания.
- AI Toolkit включва шаблони (например Python MCP сървър шаблони), за да опрости създаването на персонализирани инструменти.

## Допълнителни ресурси

- [Документация за AI Toolkit](https://aka.ms/AIToolkit/doc)

## Какво следва
- Следва: [Тестване и дебъгване](../08-testing/README.md)

**Отказ от отговорност**:  
Този документ е преведен с помощта на AI преводаческа услуга [Co-op Translator](https://github.com/Azure/co-op-translator). Въпреки че се стремим към точност, моля, имайте предвид, че автоматизираните преводи могат да съдържат грешки или неточности. Оригиналният документ на неговия роден език трябва да се счита за авторитетен източник. За критична информация се препоръчва професионален човешки превод. Ние не носим отговорност за каквито и да е недоразумения или неправилни тълкувания, произтичащи от използването на този превод.